{% extends "teacher/base.html" %}

{% block style %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="https://unpkg.com/bootstrap-table@1.19.1/dist/bootstrap-table.min.css" rel="stylesheet">

<style>

</style>

{% endblock style %}

{% block content %}
    <div class="d-sm-flex justify-content-between align-items-center my-0 mx-2">
        <h1 class="text-dark mx-3">
            <br>
            Welcome to Teacher Dashboard
        </h1>

    </div>
    <div class="container container-fluid mb-4" >
        <div class="row" style="height: auto;">

<!--            Barchart column-->
            <div class="col-lg-7 p-0 px-2">
                <div id="chartContainer" class="card h-100">
                    <div class="card-body">
                        <canvas id="stackCol" width="1000" height="700"></canvas>
                    </div>
                </div>
            </div>

<!--            New students column-->
            <div class="col-lg-5 p-0 px-2" id="joinRequestCardContainer">
                <div class="card h-100" id="joinRequestCard">
                    <div class="card-header">
                        JOIN REQUESTS
                    </div>
                    <ul id="incomingStudentList" class="list-group list-group-flush p-1" style="height: 480px; overflow-y: scroll;">
                        {% if student_requests %}
                            {% for request in student_requests %}
                                <li  class="list-group-item my-1 text-dark">
                                    <div class="row">
                                        <div class="col-8">
                                            <div>
                                                {{ request['last_name'] }}, {{ request['first_name'] }}
                                            </div>
                                            <div>
                                                {{ request['section_no'] }} - {{ request['name'] }}
                                            </div>
                                        </div>
                                        <div class="col-4">
                                            <span class="float-end">
                                                <a type="button" class="btn btn-outline-success acceptRequestButton align-middle" section_id="{{ request['section_id'] }}" action="1" student_id="{{ request['student_id'] }}">
                                                    <i class="fas fa-solid fa-check fs-5"></i>
                                                </a>
                                                <a type="button" class="btn btn-outline-danger align-middle rejectRequestButton" section_id="{{ request['section_id'] }}" action="0" student_id="{{ request['student_id'] }}">
                                                    <i class="fas fa-solid fa-xmark fs-5"></i>
                                                </a>
                                            </span>
                                        </div>
                                    </div>
                                </li>
                            {% endfor %}
                        {% else %}
                            <li  class="list-group-item my-1 text-dark">
                                <span>No Student Requests.</span>
                            </li>
                        {% endif %}
                            <li class="hr"></li>

                    </ul>
                </div>
            </div>
        </div>



    </div>

{% endblock content %}

{% block extra_js %}

<script src="{{ url_for('static', filename='js/teacherChart.js') }}"></script>
<script src="{{ url_for('static', filename='js/studentRequests.js') }}"></script>

<script src="https://unpkg.com/bootstrap-table@1.19.1/dist/bootstrap-table.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>

<script>

function detailFormatter(index, row) {
    var html = []
    $.each(row, function (key, value) {
        if(key == 'email' || key == 'mobile'){
            key = key.charAt(0).toUpperCase() + key.slice(1);
            html.push('<p><b>' + key + ':</b> ' + value + '</p>');
        }
    });
    return html.join('');
}
</script>
<script>
$(document).ready(function () {
    $("#dashboard").addClass('active');
});
</script>
{% endblock extra_js %}